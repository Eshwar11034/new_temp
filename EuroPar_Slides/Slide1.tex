% Slide 1 â€” Matrix QR Factorization (with flowchart)
\begin{frame}{Matrix QR Factorization}
  \begin{columns}[T,onlytextwidth]

    \column{0.56\textwidth}
    \begin{tightitem}
      \item \textbf{Goal:} Factor a full-rank $m\times n$ matrix $A$ as $A = Q\,R$
            with $Q^{\top}Q = I$ and $R$ upper triangular.
      \item \textbf{Why QR (vs.\ normal equations)?} Numerically stable:
            avoids forming $A^{\top}A$; solve least-squares via $R x = Q^{\top} b$.
      \item \textbf{Householder idea:} For each column, build a reflector that
            zeros subdiagonal entries; store $Q$ \emph{implicitly} via vectors $u$
            and scalars $b$.
      \item \textbf{In-place layout (used later by SLSQP):} keep $R$ in the
            upper triangle; store Householder vectors in the strict lower
            triangle and scalars $b[i]$ in a side array.
    \end{tightitem}

    \vspace{2mm}
    \small \textit{Next: the sequential algorithm and a diagram that mirrors its steps.}

    \column{0.44\textwidth}
    \centering
    % Compact flowchart (fits the column)
    \begin{tikzpicture}[font=\small, node distance=4mm, every node/.style={transform shape}, scale=0.7]
      \tikzstyle{box}=[rectangle,rounded corners,draw,align=center,inner sep=3pt,minimum width=2.7cm,fill=gray!10]
      \node[box] (A) {$A$ ($m\times n$)};
      \node[box,fill=pivotblue!12,below=of A] (HH) {Householder reflections\\(in-place)};
      \node[box,below left=8mm and -1mm of HH] (Q) {$Q$ (implicit)};
      \node[box,below right=8mm and -1mm of HH] (R) {$R$ (upper triangular)};
      \draw[-{Stealth}] (A) -- (HH);
      \draw[-{Stealth}] (HH) -- (Q);
      \draw[-{Stealth}] (HH) -- (R);

    \end{tikzpicture}

  \end{columns}
\end{frame}
